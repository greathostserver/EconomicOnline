<!doctype html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>داشبور زنده بازارها</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/choices.js/public/assets/styles/choices.min.css" />
  <style>
    body { font-family: sans-serif; margin:0; background:#111; color:#eee; }
    header { background:#222; padding:10px; display:flex; gap:10px; align-items:center; }
    select, button { padding:6px 10px; border-radius:6px; border:1px solid #444; background:#333; color:#eee; }
    .card { background:#1a1a1a; margin:10px; padding:10px; border-radius:8px; }
    .status { font-size:13px; color:#aaa; margin-top:6px; }
    .delta-up { color:#2ecc71; font-weight:bold; }
    .delta-down { color:#e74c3c; font-weight:bold; }
  </style>
</head>
<body>
<header>
  <strong id="title">داشبور زنده بازارها</strong>
  <select id="langSelect">
    <option value="fa">فارسی</option>
    <option value="ar">العربية</option>
    <option value="en">English</option>
    <option value="ru">Русский</option>
  </select>
  <button id="toggleTheme">تم روشن/تاریک</button>
</header>

<main>
  <section class="card">
    <h3 id="cryptoTitle">کریپتو از Binance</h3>
    <select id="pairSelect"></select>
    <div class="status" id="cryptoStatus">در حال بارگذاری جفت‌ارزها…</div>
    <div id="pairInfo"></div>
  </section>
</main>

<script src="https://cdn.jsdelivr.net/npm/choices.js/public/assets/scripts/choices.min.js"></script>
<script>
const i18n = {
  fa:{title:'داشبور زنده بازارها',cryptoTitle:'کریپتو از Binance',cryptoStatus:'در حال بارگذاری جفت‌ارزها…'},
  ar:{title:'لوحة الأسواق الحية',cryptoTitle:'كريبتو من Binance',cryptoStatus:'جارٍ تحميل الأزواج…'},
  en:{title:'Live markets dashboard',cryptoTitle:'Crypto from Binance',cryptoStatus:'Loading pairs…'},
  ru:{title:'Панель живых рынков',cryptoTitle:'Крипто с Binance',cryptoStatus:'Загрузка пар…'}
};
let lang='fa';

function applyLang(){
  const p=i18n[lang];
  document.getElementById('title').textContent=p.title;
  document.getElementById('cryptoTitle').textContent=p.cryptoTitle;
  document.getElementById('cryptoStatus').textContent=p.cryptoStatus;
}

document.getElementById('langSelect').addEventListener('change',e=>{
  lang=e.target.value; applyLang();
});

document.getElementById('toggleTheme').addEventListener('click',()=>{
  document.body.style.background=document.body.style.background==='#111'?'#f6f7fb':'#111';
  document.body.style.color=document.body.style.color==='#eee'?'#111':'#eee';
});

async function loadPairs(){
  const status=document.getElementById('cryptoStatus');
  const select=document.getElementById('pairSelect');
  try{
    const res=await fetch('https://api.binance.com/api/v3/ticker/24hr');
    const data=await res.json();
    const pairs=data.filter(d=>d.symbol.endsWith('USDT'));
    select.innerHTML=pairs.map(p=>`<option value="${p.symbol}">${p.symbol}</option>`).join('');
    new Choices(select,{searchEnabled:true,itemSelectText:''});
    status.textContent=i18n[lang].cryptoStatus;
    select.addEventListener('change',e=>{
      const symbol=e.target.value;
      const info=pairs.find(p=>p.symbol===symbol);
      document.getElementById('pairInfo').innerHTML=`
        <strong>${symbol}</strong><br>
        قیمت: $${Number(info.lastPrice).toLocaleString()}<br>
        تغییر 24h: <span class="${info.priceChangePercent>=0?'delta-up':'delta-down'}">
          ${info.priceChangePercent}%
        </span><br>
        حجم 24h: $${Number(info.quoteVolume).toLocaleString()}
      `;
    });
    // نمایش پیش‌فرض اولین ارز
    select.value=pairs[0].symbol;
    select.dispatchEvent(new Event('change'));
  }catch(e){
    status.textContent='خطا در دریافت داده‌ها';
  }
}

document.addEventListener('DOMContentLoaded',()=>{
  applyLang();
  loadPairs();
});
</script>
</body>
</html>
